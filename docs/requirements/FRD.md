# ğŸ® å¤šäººå³æ™‚éŠæˆ²å¹³å° - åŠŸèƒ½éœ€æ±‚æ–‡ä»¶ (FRD)

## ğŸ“‹ æ–‡ä»¶è³‡è¨Š

| é …ç›® | å…§å®¹ |
|------|------|
| **æ–‡ä»¶ç‰ˆæœ¬** | 1.0 |
| **å»ºç«‹æ—¥æœŸ** | 2024å¹´12æœˆ |
| **æ–‡ä»¶ç‹€æ…‹** | è‰ç¨¿ |
| **è² è²¬äºº** | ç³»çµ±åˆ†æå¸« |
| **ç›¸é—œæ–‡ä»¶** | BRD.md, PRD.md |

---

## ğŸ¯ 1. ç³»çµ±æ¦‚è¿°

### 1.1 ç³»çµ±ç›®æ¨™
å»ºç«‹ä¸€å€‹**å³æ™‚ã€ç©©å®šã€æ˜“ç”¨çš„å¤šäººéŠæˆ²å¹³å°**ï¼Œæ”¯æ´å¤šæˆ¿é–“ã€å¤šç©å®¶åŒæ™‚é€²è¡Œè²ªé£Ÿè›‡éŠæˆ²ï¼Œä¸¦æä¾›è±å¯Œçš„ç¤¾äº¤äº’å‹•åŠŸèƒ½ã€‚

### 1.2 ç³»çµ±ç¯„åœ
- **åŒ…å«**: ç”¨æˆ¶ç®¡ç†ã€éŠæˆ²å¤§å»³ã€æˆ¿é–“ç®¡ç†ã€å¤šäººéŠæˆ²ã€å³æ™‚èŠå¤©
- **ä¸åŒ…å«**: ç”¨æˆ¶è¨»å†Šã€å¯†ç¢¼ç®¡ç†ã€ä»˜è²»åŠŸèƒ½ã€å»£å‘Šç³»çµ±

### 1.3 ç³»çµ±æ¶æ§‹
- **å‰ç«¯**: React.js + Socket.IO Client
- **å¾Œç«¯**: Node.js + Express + Socket.IO
- **é€šè¨Š**: WebSocket å³æ™‚é€šè¨Š
- **éƒ¨ç½²**: Railway (å¾Œç«¯) + Netlify (å‰ç«¯)

---

## ğŸ‘¥ 2. ç”¨æˆ¶è§’è‰²å®šç¾©

### 2.1 ä¸»è¦è§’è‰²

#### 2.1.1 éŠæˆ²ç©å®¶ (Player)
- **æè¿°**: ä½¿ç”¨å¹³å°é€²è¡ŒéŠæˆ²çš„ä¸»è¦ç”¨æˆ¶
- **æ¬Šé™**: ç™»å…¥ã€èŠå¤©ã€å‰µå»ºæˆ¿é–“ã€åŠ å…¥æˆ¿é–“ã€åƒèˆ‡éŠæˆ²

#### 2.1.2 æˆ¿ä¸» (Host)
- **æè¿°**: å‰µå»ºéŠæˆ²æˆ¿é–“çš„ç©å®¶
- **ç‰¹æ®Šæ¬Šé™**: é–‹å§‹éŠæˆ²ã€çµæŸéŠæˆ²ã€ç®¡ç†æˆ¿é–“è¨­å®š

#### 2.1.3 ç³»çµ±ç®¡ç†å“¡ (Admin)
- **æè¿°**: ç®¡ç†å¹³å°é‹ç‡Ÿçš„æŠ€è¡“äººå“¡
- **æ¬Šé™**: ç›£æ§ç³»çµ±ã€è™•ç†å•é¡Œã€å„ªåŒ–æ€§èƒ½

---

## ğŸ® 3. åŠŸèƒ½éœ€æ±‚è©³ç´°è¦æ ¼

### 3.1 ç”¨æˆ¶ç®¡ç†æ¨¡çµ„

#### 3.1.1 ç”¨æˆ¶ç™»å…¥åŠŸèƒ½

**åŠŸèƒ½æè¿°**: ç©å®¶é€šéè¼¸å…¥åç¨±é€²å…¥éŠæˆ²ç³»çµ±

**è¼¸å…¥è¦æ ¼**:
- **ç©å®¶åç¨±**: å­—ä¸²é¡å‹ï¼Œé•·åº¦ 1-20 å­—å…ƒ
- **é€£æ¥ç‹€æ…‹**: å¸ƒæ—å€¼ï¼Œè¡¨ç¤ºèˆ‡ä¼ºæœå™¨çš„é€£æ¥ç‹€æ…‹

**è¼¸å‡ºè¦æ ¼**:
- **ç™»å…¥æˆåŠŸ**: è¿”å›ç©å®¶è³‡è¨Šå’Œé€²å…¥å¤§å»³
- **ç™»å…¥å¤±æ•—**: é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯

**æ¥­å‹™è¦å‰‡**:
```
1. åç¨±ä¸èƒ½ç‚ºç©º
2. åç¨±é•·åº¦é™åˆ¶ 1-20 å­—å…ƒ
3. é‡è¤‡åç¨±è‡ªå‹•è™•ç†ï¼ˆä½¿ç”¨ Socket ID å€åˆ†ï¼‰
4. å¿…é ˆå…ˆå»ºç«‹ WebSocket é€£æ¥æ‰èƒ½ç™»å…¥
```

**ç•°å¸¸è™•ç†**:
- ç¶²è·¯é€£æ¥å¤±æ•—æ™‚é¡¯ç¤º"é€£æ¥ä¸­..."
- åç¨±é©—è­‰å¤±æ•—æ™‚æç¤ºé‡æ–°è¼¸å…¥
- ä¼ºæœå™¨éŒ¯èª¤æ™‚é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯

#### 3.1.2 ç”¨æˆ¶ç‹€æ…‹ç®¡ç†

**åŠŸèƒ½æè¿°**: è¿½è¹¤å’Œç®¡ç†ç”¨æˆ¶åœ¨ç·šç‹€æ…‹

**ç‹€æ…‹å®šç¾©**:
```javascript
const player = {
  id: socket.id,           // ç”¨æˆ¶å”¯ä¸€æ¨™è­˜
  name: playerName,        // ç”¨æˆ¶åç¨±
  status: 'online',        // ç‹€æ…‹: online, offline, in-game
  joinTime: timestamp,     // åŠ å…¥æ™‚é–“
  currentRoom: null        // ç•¶å‰æˆ¿é–“ ID
};
```

**ç‹€æ…‹æ›´æ–°æ©Ÿåˆ¶**:
- å³æ™‚åŒæ­¥åˆ°æ‰€æœ‰å®¢æˆ¶ç«¯
- æ–·ç·šæ™‚è‡ªå‹•æ¸…ç†ç”¨æˆ¶ç‹€æ…‹
- é‡æ–°é€£æ¥æ™‚æ¢å¾©ç”¨æˆ¶ç‹€æ…‹

### 3.2 éŠæˆ²å¤§å»³æ¨¡çµ„

#### 3.2.1 å¤§å»³é¡¯ç¤ºåŠŸèƒ½

**åŠŸèƒ½æè¿°**: é¡¯ç¤ºåœ¨ç·šç©å®¶å’Œå¯ç”¨æˆ¿é–“

**é¡¯ç¤ºå…§å®¹**:
```javascript
const lobbyState = {
  players: [],     // åœ¨ç·šç©å®¶åˆ—è¡¨
  rooms: [],       // å¯ç”¨æˆ¿é–“åˆ—è¡¨
  chat: []         // å¤§å»³èŠå¤©è¨˜éŒ„
};
```

**å³æ™‚æ›´æ–°æ©Ÿåˆ¶**:
- æ–°ç©å®¶åŠ å…¥æ™‚æ›´æ–°ç©å®¶åˆ—è¡¨
- ç©å®¶é›¢é–‹æ™‚å¾åˆ—è¡¨ä¸­ç§»é™¤
- æˆ¿é–“ç‹€æ…‹è®ŠåŒ–æ™‚æ›´æ–°æˆ¿é–“åˆ—è¡¨

#### 3.2.2 å¤§å»³èŠå¤©åŠŸèƒ½

**åŠŸèƒ½æè¿°**: å¤§å»³å…§ç©å®¶é–“çš„å³æ™‚èŠå¤©

**è¨Šæ¯æ ¼å¼**:
```javascript
const chatMessage = {
  id: timestamp,           // è¨Šæ¯å”¯ä¸€æ¨™è­˜
  playerId: socket.id,     // ç™¼é€è€… ID
  playerName: player.name, // ç™¼é€è€…åç¨±
  message: message,        // è¨Šæ¯å…§å®¹
  timestamp: timestamp,    // ç™¼é€æ™‚é–“
  type: 'lobby'           // è¨Šæ¯é¡å‹
};
```

**é™åˆ¶è¦å‰‡**:
- æœ€å¤šä¿ç•™ 100 æ¢æ­·å²è¨Šæ¯
- è¨Šæ¯é•·åº¦é™åˆ¶ 200 å­—å…ƒ
- é˜²æ­¢ XSS æ”»æ“Š

### 3.3 æˆ¿é–“ç®¡ç†æ¨¡çµ„

#### 3.3.1 å‰µå»ºæˆ¿é–“åŠŸèƒ½

**åŠŸèƒ½æè¿°**: ç©å®¶å¯ä»¥å‰µå»ºæ–°çš„éŠæˆ²æˆ¿é–“

**æˆ¿é–“è¨­å®š**:
```javascript
const roomData = {
  name: roomName,              // æˆ¿é–“åç¨±
  maxPlayers: 2-8,            // æœ€å¤§ç©å®¶æ•¸
  gameType: 'fruit-eating',   // éŠæˆ²é¡å‹
  gameDuration: 30|60         // éŠæˆ²æ™‚é•·ï¼ˆç§’ï¼‰
};
```

**å‰µå»ºæµç¨‹**:
1. é©—è­‰æˆ¿é–“åç¨±ä¸ç‚ºç©º
2. ç”Ÿæˆå”¯ä¸€æˆ¿é–“ ID
3. å°‡å‰µå»ºè€…è¨­ç‚ºæˆ¿ä¸»
4. å°‡å‰µå»ºè€…åŠ å…¥æˆ¿é–“
5. é€šçŸ¥æ‰€æœ‰ç©å®¶æˆ¿é–“å‰µå»º

**æˆ¿é–“ç‹€æ…‹**:
- `waiting`: ç­‰å¾…ç©å®¶åŠ å…¥
- `playing`: éŠæˆ²é€²è¡Œä¸­
- `finished`: éŠæˆ²å·²çµæŸ

#### 3.3.2 åŠ å…¥æˆ¿é–“åŠŸèƒ½

**åŠŸèƒ½æè¿°**: ç©å®¶å¯ä»¥åŠ å…¥ç¾æœ‰æˆ¿é–“

**é™åˆ¶æ¢ä»¶**:
```
1. æˆ¿é–“å¿…é ˆå­˜åœ¨
2. æˆ¿é–“ç‹€æ…‹å¿…é ˆç‚º 'waiting'
3. æˆ¿é–“æœªæ»¿å“¡
4. ç©å®¶ä¸åœ¨å…¶ä»–æˆ¿é–“ä¸­
```

**åŠ å…¥æµç¨‹**:
1. é©—è­‰åŠ å…¥æ¢ä»¶
2. å°‡ç©å®¶åŠ å…¥æˆ¿é–“
3. é€šçŸ¥æˆ¿é–“å…§å…¶ä»–ç©å®¶
4. æ›´æ–°å¤§å»³ç‹€æ…‹

**ç•°å¸¸è™•ç†**:
- æˆ¿é–“ä¸å­˜åœ¨æ™‚é¡¯ç¤ºéŒ¯èª¤
- æˆ¿é–“å·²æ»¿æ™‚é¡¯ç¤ºéŒ¯èª¤
- éŠæˆ²é€²è¡Œä¸­æ™‚æ‹’çµ•åŠ å…¥

#### 3.3.3 é›¢é–‹æˆ¿é–“åŠŸèƒ½

**åŠŸèƒ½æè¿°**: ç©å®¶å¯ä»¥ä¸»å‹•é›¢é–‹æˆ¿é–“

**è™•ç†é‚è¼¯**:
```javascript
// é›¢é–‹æˆ¿é–“æµç¨‹
1. å¾æˆ¿é–“ç©å®¶åˆ—è¡¨ä¸­ç§»é™¤
2. æ¸…ç©ºç©å®¶ç•¶å‰æˆ¿é–“ç‹€æ…‹
3. å¦‚æœæˆ¿é–“ç©ºäº†ï¼Œåˆªé™¤æˆ¿é–“
4. å¦‚æœæˆ¿ä¸»é›¢é–‹ï¼Œè½‰ç§»æˆ¿ä¸»æ¬Šé™
5. é€šçŸ¥å…¶ä»–ç©å®¶
6. æ›´æ–°å¤§å»³ç‹€æ…‹
```

**æˆ¿ä¸»æ¬Šé™è½‰ç§»**:
- æˆ¿ä¸»é›¢é–‹æ™‚è‡ªå‹•è½‰ç§»çµ¦ç¬¬ä¸€å€‹ç©å®¶
- æ›´æ–°æˆ¿é–“çš„ host å’Œ hostName æ¬„ä½
- é€šçŸ¥æ‰€æœ‰ç©å®¶æ¬Šé™è®Šæ›´

### 3.4 éŠæˆ²åŠŸèƒ½æ¨¡çµ„

#### 3.4.1 éŠæˆ²é–‹å§‹åŠŸèƒ½

**è§¸ç™¼æ¢ä»¶**: æˆ¿ä¸»é»æ“Šé–‹å§‹éŠæˆ²

**åˆå§‹åŒ–æµç¨‹**:
```javascript
// éŠæˆ²åˆå§‹åŒ–
1. è¨­å®šæˆ¿é–“ç‹€æ…‹ç‚º 'playing'
2. åˆå§‹åŒ–éŠæˆ²æ•¸æ“šçµæ§‹
3. ç‚ºæ¯å€‹ç©å®¶åˆå§‹åŒ–è›‡å’Œåˆ†æ•¸
4. ç”Ÿæˆåˆå§‹é£Ÿç‰©
5. è¨­å®šéŠæˆ²æ™‚é•·
6. é€šçŸ¥æ‰€æœ‰ç©å®¶éŠæˆ²é–‹å§‹
```

**éŠæˆ²æ•¸æ“šçµæ§‹**:
```javascript
const gameData = {
  startTime: Date.now(),        // é–‹å§‹æ™‚é–“
  duration: gameDuration * 1000, // éŠæˆ²æ™‚é•·ï¼ˆæ¯«ç§’ï¼‰
  food: [],                     // é£Ÿç‰©åˆ—è¡¨
  scores: {},                   // ç©å®¶åˆ†æ•¸
  gameStarted: true            // éŠæˆ²ç‹€æ…‹
};
```

**ç©å®¶åˆå§‹åŒ–**:
```javascript
const playerScore = {
  score: 0,
  snake: {
    body: [{x: 10, y: 10}],    // è›‡èº«
    direction: 'right',         // æ–¹å‘
    color: randomColor()        // é¡è‰²
  }
};
```

#### 3.4.2 éŠæˆ²é€²è¡ŒåŠŸèƒ½

**æ§åˆ¶æ–¹å¼**:
- **éµç›¤æ§åˆ¶**: æ–¹å‘éµ (â†‘â†“â†â†’)
- **è™›æ“¬æŒ‰éˆ•**: è§¸æ§è¨­å‚™æ”¯æ´

**éŠæˆ²é‚è¼¯**:
```javascript
// è›‡çš„ç§»å‹•é‚è¼¯
function moveSnake(snake, direction) {
  const head = snake.body[0];
  let newHead = { ...head };
  
  switch (direction) {
    case 'up': newHead.y = Math.max(0, head.y - 1); break;
    case 'down': newHead.y = Math.min(19, head.y + 1); break;
    case 'left': newHead.x = Math.max(0, head.x - 1); break;
    case 'right': newHead.x = Math.min(19, head.x + 1); break;
  }
  
  // æª¢æŸ¥ç¢°æ’
  const collision = snake.body.some(segment => 
    segment.x === newHead.x && segment.y === newHead.y
  );
  
  if (!collision) {
    snake.body.unshift(newHead);
    snake.body.pop();
  }
}
```

**é£Ÿç‰©ç³»çµ±**:
```javascript
// é£Ÿç‰©ç”Ÿæˆå’Œæ”¶é›†
1. åˆå§‹ç”Ÿæˆ 5 å€‹é£Ÿç‰©
2. é£Ÿç‰©è¢«åƒæ‰æ™‚ç”Ÿæˆæ–°é£Ÿç‰©
3. ä¿æŒå ´ä¸Šæœ€å¤š 5 å€‹é£Ÿç‰©
4. æ¯å€‹é£Ÿç‰© 10 åˆ†
```

**åˆ†æ•¸è¨ˆç®—**:
- æ¯åƒä¸€å€‹é£Ÿç‰©å¾— 10 åˆ†
- å³æ™‚æ›´æ–°åˆ†æ•¸æ’è¡Œæ¦œ
- æ‰€æœ‰ç©å®¶åŒæ­¥çœ‹åˆ°æœ€æ–°åˆ†æ•¸

#### 3.4.3 éŠæˆ²çµæŸåŠŸèƒ½

**çµæŸæ¢ä»¶**:
- æ™‚é–“åˆ°ï¼ˆ30ç§’æˆ–60ç§’ï¼‰
- æˆ¿ä¸»æ‰‹å‹•çµæŸéŠæˆ²

**çµæŸæµç¨‹**:
```javascript
// éŠæˆ²çµæŸè™•ç†
1. è¨­å®šæˆ¿é–“ç‹€æ…‹ç‚º 'finished'
2. è¨ˆç®—æœ€çµ‚åˆ†æ•¸å’Œç²å‹è€…
3. é€šçŸ¥æ‰€æœ‰ç©å®¶éŠæˆ²çµæŸ
4. é¡¯ç¤ºç²å‹è€…ä¿¡æ¯
5. æ¸…ç†éŠæˆ²æ•¸æ“š
6. é‡ç½®æˆ¿é–“ç‹€æ…‹
```

**çµæœçµ±è¨ˆ**:
```javascript
const gameResult = {
  winner: {
    playerId: winnerId,
    playerName: winnerName,
    score: winnerScore
  },
  scores: allPlayerScores,
  duration: actualGameTime
};
```

### 3.5 èŠå¤©åŠŸèƒ½æ¨¡çµ„

#### 3.5.1 å¤§å»³èŠå¤©åŠŸèƒ½

**åŠŸèƒ½æè¿°**: å¤§å»³å…§æ‰€æœ‰ç©å®¶å¯è¦‹çš„èŠå¤©

**è¨Šæ¯è™•ç†**:
```javascript
// å¤§å»³èŠå¤©è™•ç†
1. é©—è­‰è¨Šæ¯å…§å®¹
2. å‰µå»ºèŠå¤©è¨Šæ¯å°è±¡
3. æ·»åŠ åˆ°å¤§å»³èŠå¤©è¨˜éŒ„
4. é™åˆ¶è¨˜éŒ„æ•¸é‡ï¼ˆæœ€å¤š100æ¢ï¼‰
5. å»£æ’­çµ¦æ‰€æœ‰ç©å®¶
```

**è¨Šæ¯æ ¼å¼**:
```javascript
const lobbyMessage = {
  id: Date.now(),
  playerId: socket.id,
  playerName: player.name,
  message: message,
  timestamp: new Date().toISOString(),
  type: 'lobby'
};
```

#### 3.5.2 æˆ¿é–“èŠå¤©åŠŸèƒ½

**åŠŸèƒ½æè¿°**: æˆ¿é–“å…§ç©å®¶é–“çš„ç§å¯†èŠå¤©

**å¯è¦‹ç¯„åœ**: åƒ…æˆ¿é–“å…§ç©å®¶å¯è¦‹

**è¨Šæ¯è™•ç†**:
```javascript
// æˆ¿é–“èŠå¤©è™•ç†
1. é©—è­‰ç©å®¶åœ¨æˆ¿é–“ä¸­
2. å‰µå»ºæˆ¿é–“èŠå¤©è¨Šæ¯
3. æ·»åŠ åˆ°æˆ¿é–“èŠå¤©è¨˜éŒ„
4. åªç™¼é€çµ¦æˆ¿é–“å…§ç©å®¶
```

**è¨Šæ¯æ ¼å¼**:
```javascript
const roomMessage = {
  id: Date.now(),
  playerId: socket.id,
  playerName: player.name,
  message: message,
  timestamp: new Date().toISOString(),
  type: 'room',
  roomId: roomId
};
```

---

## ğŸ¨ 4. ç”¨æˆ¶ç•Œé¢éœ€æ±‚

### 4.1 ç™»å…¥ç•Œé¢

**ç•Œé¢å…ƒç´ **:
- éŠæˆ²æ¨™é¡Œ
- åç¨±è¼¸å…¥æ¡†
- ç™»å…¥æŒ‰éˆ•
- é€£æ¥ç‹€æ…‹é¡¯ç¤º

**äº¤äº’é‚è¼¯**:
```javascript
// ç™»å…¥é©—è­‰
1. æª¢æŸ¥åç¨±æ˜¯å¦ç‚ºç©º
2. æª¢æŸ¥é€£æ¥ç‹€æ…‹
3. ç™¼é€ç™»å…¥è«‹æ±‚
4. ç­‰å¾…ä¼ºæœå™¨å›æ‡‰
5. æˆåŠŸå¾Œé€²å…¥å¤§å»³
```

### 4.2 éŠæˆ²å¤§å»³ç•Œé¢

**ç•Œé¢ä½ˆå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éŠæˆ²å¤§å»³æ¨™é¡Œ + ç‹€æ…‹ä¿¡æ¯              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¤§å»³èŠå¤©å€åŸŸ     â”‚ å´é‚Šæ¬„            â”‚
â”‚                 â”‚ â”œ åœ¨ç·šç©å®¶åˆ—è¡¨     â”‚
â”‚                 â”‚ â”” éŠæˆ²æˆ¿é–“åˆ—è¡¨     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å³æ™‚æ›´æ–°**:
- ç©å®¶åˆ—è¡¨å³æ™‚æ›´æ–°
- æˆ¿é–“åˆ—è¡¨å³æ™‚æ›´æ–°
- èŠå¤©è¨Šæ¯å³æ™‚é¡¯ç¤º

### 4.3 æˆ¿é–“ç•Œé¢

**ç•Œé¢ä½ˆå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æˆ¿é–“æ¨™é¡Œ + æˆ¿é–“ä¿¡æ¯ + æ§åˆ¶æŒ‰éˆ•       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æˆ¿é–“ç©å®¶åˆ—è¡¨     â”‚ éŠæˆ²å€åŸŸ          â”‚
â”‚                 â”‚ â”œ éŠæˆ²ç•«å¸ƒ        â”‚
â”‚                 â”‚ â”œ åˆ†æ•¸æ’è¡Œæ¦œ      â”‚
â”‚                 â”‚ â”” è™›æ“¬éµç›¤        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**éŠæˆ²ç‹€æ…‹é¡¯ç¤º**:
- éŠæˆ²é€²è¡Œæ™‚é¡¯ç¤ºå€’è¨ˆæ™‚
- å³æ™‚æ›´æ–°åˆ†æ•¸æ’è¡Œæ¦œ
- é¡¯ç¤ºéŠæˆ²èªªæ˜

### 4.4 éŠæˆ²ç•Œé¢

**éŠæˆ²ç•«å¸ƒ**:
- 400x400 åƒç´ ç•«å¸ƒ
- 20x20 ç¶²æ ¼èƒŒæ™¯
- ä¸åŒé¡è‰²çš„è›‡èº«
- ç´…è‰²é£Ÿç‰©æ–¹å¡Š

**æ§åˆ¶æ–¹å¼**:
- éµç›¤æ–¹å‘éµæ§åˆ¶
- è™›æ“¬æŒ‰éˆ•æ§åˆ¶
- é˜²æ­¢é‡è¤‡æŒ‰éµ

---

## ğŸ”§ 5. æŠ€è¡“éœ€æ±‚

### 5.1 å‰ç«¯æŠ€è¡“è¦æ ¼

#### 5.1.1 React çµ„ä»¶çµæ§‹
```javascript
// ä¸»è¦çµ„ä»¶
App.js
â”œâ”€â”€ LoginView          // ç™»å…¥ç•Œé¢
â”œâ”€â”€ LobbyView          // å¤§å»³ç•Œé¢
â””â”€â”€ RoomView           // æˆ¿é–“ç•Œé¢
    â”œâ”€â”€ GameCanvas     // éŠæˆ²ç•«å¸ƒ
    â”œâ”€â”€ ScoreBoard     // åˆ†æ•¸æ’è¡Œæ¦œ
    â”œâ”€â”€ VirtualKeyboard // è™›æ“¬éµç›¤
    â””â”€â”€ ChatPanel      // èŠå¤©é¢æ¿
```

#### 5.1.2 ç‹€æ…‹ç®¡ç†
```javascript
// ä¸»è¦ç‹€æ…‹
const [socket, setSocket] = useState(null);
const [connected, setConnected] = useState(false);
const [currentPlayer, setCurrentPlayer] = useState(null);
const [currentView, setCurrentView] = useState('login');
const [currentRoom, setCurrentRoom] = useState(null);
const [gameData, setGameData] = useState(null);
const [gameStarted, setGameStarted] = useState(false);
```

### 5.2 å¾Œç«¯æŠ€è¡“è¦æ ¼

#### 5.2.1 Socket.IO äº‹ä»¶å®šç¾©
```javascript
// å®¢æˆ¶ç«¯ç™¼é€äº‹ä»¶
'player-login'          // ç©å®¶ç™»å…¥
'lobby-chat'           // å¤§å»³èŠå¤©
'create-room'          // å‰µå»ºæˆ¿é–“
'join-room'            // åŠ å…¥æˆ¿é–“
'leave-room'           // é›¢é–‹æˆ¿é–“
'start-game'           // é–‹å§‹éŠæˆ²
'game-action'          // éŠæˆ²å‹•ä½œ
'room-chat'            // æˆ¿é–“èŠå¤©

// ä¼ºæœå™¨ç™¼é€äº‹ä»¶
'player-logged-in'     // ç™»å…¥æˆåŠŸ
'lobby-player-joined'  // ç©å®¶åŠ å…¥å¤§å»³
'lobby-player-left'    // ç©å®¶é›¢é–‹å¤§å»³
'lobby-new-message'    // æ–°èŠå¤©è¨Šæ¯
'lobby-state-update'   // å¤§å»³ç‹€æ…‹æ›´æ–°
'room-created'         // æˆ¿é–“å‰µå»º
'room-joined'          // åŠ å…¥æˆ¿é–“æˆåŠŸ
'room-player-joined'   // ç©å®¶åŠ å…¥æˆ¿é–“
'room-player-left'     // ç©å®¶é›¢é–‹æˆ¿é–“
'room-deleted'         // æˆ¿é–“åˆªé™¤
'room-join-error'      // åŠ å…¥æˆ¿é–“éŒ¯èª¤
'room-new-message'     // æˆ¿é–“æ–°è¨Šæ¯
'game-started'         // éŠæˆ²é–‹å§‹
'game-ended'           // éŠæˆ²çµæŸ
'player-moved'         // ç©å®¶ç§»å‹•
'game-state-update'    // éŠæˆ²ç‹€æ…‹æ›´æ–°
```

#### 5.2.2 æ•¸æ“šçµæ§‹å®šç¾©
```javascript
// éŠæˆ²ç‹€æ…‹
const gameState = {
  lobby: {
    players: {},    // å¤§å»³ç©å®¶
    chat: [],       // å¤§å»³èŠå¤©
    rooms: {}       // æˆ¿é–“åˆ—è¡¨
  },
  rooms: {}         // æˆ¿é–“è©³ç´°æ•¸æ“š
};

// ç©å®¶æ•¸æ“š
const player = {
  id: socket.id,
  name: playerName,
  status: 'online',
  joinTime: timestamp,
  currentRoom: null
};

// æˆ¿é–“æ•¸æ“š
const room = {
  id: roomId,
  name: roomName,
  host: hostId,
  hostName: hostName,
  players: {},
  maxPlayers: maxPlayers,
  status: 'waiting',
  gameType: 'fruit-eating',
  gameDuration: duration,
  createdAt: timestamp,
  gameData: {}
};
```

### 5.3 æ€§èƒ½éœ€æ±‚

#### 5.3.1 éŸ¿æ‡‰æ™‚é–“è¦æ±‚
- **ç”¨æˆ¶æ“ä½œéŸ¿æ‡‰**: < 100ms
- **éŠæˆ²åŒæ­¥å»¶é²**: < 50ms
- **èŠå¤©è¨Šæ¯å»¶é²**: < 200ms
- **é é¢è¼‰å…¥æ™‚é–“**: < 3ç§’

#### 5.3.2 ä¸¦ç™¼è™•ç†
- **åŒæ™‚åœ¨ç·šç”¨æˆ¶**: æ”¯æ´ 100+ ç”¨æˆ¶
- **å–®æˆ¿é–“æœ€å¤§ç©å®¶**: 8 äºº
- **åŒæ™‚éŠæˆ²æˆ¿é–“**: æ”¯æ´ 50+ æˆ¿é–“

#### 5.3.3 æ•¸æ“šè™•ç†
- **èŠå¤©è¨˜éŒ„é™åˆ¶**: æœ€å¤š 100 æ¢
- **éŠæˆ²ç‹€æ…‹æ›´æ–°é »ç‡**: 60fps
- **è‡ªå‹•æ¸…ç†é–“éš”**: æ¯ç§’æª¢æŸ¥

---

## ğŸ›¡ï¸ 6. å®‰å…¨éœ€æ±‚

### 6.1 è¼¸å…¥é©—è­‰
```javascript
// åç¨±é©—è­‰
function validatePlayerName(name) {
  return name && name.trim().length > 0 && name.length <= 20;
}

// èŠå¤©è¨Šæ¯é©—è­‰
function validateChatMessage(message) {
  return message && message.trim().length > 0 && message.length <= 200;
}
```

### 6.2 XSS é˜²è­·
- æ‰€æœ‰ç”¨æˆ¶è¼¸å…¥é€²è¡Œ HTML è½‰ç¾©
- èŠå¤©è¨Šæ¯ä¸å…è¨± HTML æ¨™ç±¤
- ä½¿ç”¨ React çš„å…§å»º XSS é˜²è­·

### 6.3 CORS è¨­å®š
```javascript
// CORS é…ç½®
const corsOptions = {
  origin: process.env.NODE_ENV === 'production' 
    ? true 
    : ["http://localhost:3000"],
  methods: ["GET", "POST"],
  credentials: true
};
```

---

## ğŸ“Š 7. éŒ¯èª¤è™•ç†

### 7.1 ç¶²è·¯éŒ¯èª¤è™•ç†
```javascript
// é€£æ¥éŒ¯èª¤è™•ç†
socket.on('connect_error', (error) => {
  console.log('é€£æ¥éŒ¯èª¤:', error);
  setConnected(false);
});

socket.on('disconnect', (reason) => {
  console.log('æ–·ç·š:', reason);
  setConnected(false);
});
```

### 7.2 éŠæˆ²éŒ¯èª¤è™•ç†
```javascript
// æˆ¿é–“åŠ å…¥éŒ¯èª¤
socket.on('room-join-error', (error) => {
  alert(`åŠ å…¥æˆ¿é–“å¤±æ•—: ${error}`);
});

// éŠæˆ²å‹•ä½œéŒ¯èª¤
if (!gameStarted || !currentPlayer) {
  console.log('éŠæˆ²æœªé–‹å§‹æˆ–ç©å®¶æœªç™»å…¥');
  return;
}
```

### 7.3 æ•¸æ“šé©—è­‰éŒ¯èª¤
```javascript
// æ•¸æ“šé©—è­‰
if (!player || !player.currentRoom) {
  console.log('ç©å®¶æˆ–æˆ¿é–“æ•¸æ“šç„¡æ•ˆ');
  return;
}
```

---

## âœ… 8. é©—æ”¶æ¨™æº–

### 8.1 åŠŸèƒ½é©—æ”¶
- [ ] ç”¨æˆ¶èƒ½å¤ æˆåŠŸç™»å…¥ç³»çµ±
- [ ] éŠæˆ²å¤§å»³æ­£å¸¸é¡¯ç¤ºå’Œæ›´æ–°
- [ ] æˆ¿é–“å‰µå»ºå’ŒåŠ å…¥åŠŸèƒ½æ­£å¸¸
- [ ] å¤šäººéŠæˆ²èƒ½å¤ æ­£å¸¸é€²è¡Œ
- [ ] èŠå¤©åŠŸèƒ½æ­£å¸¸é‹ä½œ
- [ ] éŠæˆ²åŒæ­¥æº–ç¢ºç„¡èª¤
- [ ] éŒ¯èª¤è™•ç†æ©Ÿåˆ¶æ­£å¸¸

### 8.2 æ€§èƒ½é©—æ”¶
- [ ] ç³»çµ±éŸ¿æ‡‰æ™‚é–“ < 100ms
- [ ] æ”¯æ´ 50+ åŒæ™‚åœ¨ç·šç”¨æˆ¶
- [ ] éŠæˆ²åŒæ­¥å»¶é² < 50ms
- [ ] ç³»çµ±å¯ç”¨æ€§ > 99%

### 8.3 å®‰å…¨é©—æ”¶
- [ ] è¼¸å…¥é©—è­‰æ©Ÿåˆ¶æ­£å¸¸
- [ ] XSS é˜²è­·æœ‰æ•ˆ
- [ ] CORS è¨­å®šæ­£ç¢º
- [ ] éŒ¯èª¤è¨Šæ¯ä¸æ´©éœ²æ•æ„Ÿä¿¡æ¯

---

## ğŸ“ 9. é™„éŒ„

### 9.1 è¡“èªå®šç¾©
- **Socket.IO**: ç”¨æ–¼å³æ™‚é€šè¨Šçš„ JavaScript åº«
- **WebSocket**: æä¾›å…¨é›™å·¥é€šè¨Šçš„å”è­°
- **éŠæˆ²åŒæ­¥**: æ‰€æœ‰ç©å®¶çœ‹åˆ°ç›¸åŒçš„éŠæˆ²ç‹€æ…‹
- **æˆ¿ä¸»æ¬Šé™**: å‰µå»ºæˆ¿é–“ç©å®¶çš„ç‰¹æ®Šæ¬Šé™

### 9.2 åƒè€ƒæ–‡æª”
- æ¥­å‹™éœ€æ±‚æ–‡ä»¶ (BRD)
- ç”¢å“éœ€æ±‚æ–‡ä»¶ (PRD)
- æŠ€è¡“æ¶æ§‹æ–‡ä»¶
- API è¨­è¨ˆæ–‡ä»¶

---

**æ–‡ä»¶çµæŸ**

*æ­¤æ–‡ä»¶åŸºæ–¼ç¨‹å¼ç¢¼é€†å‘å·¥ç¨‹åˆ†æï¼Œåæ˜ äº†ç•¶å‰ç³»çµ±çš„å¯¦éš›åŠŸèƒ½éœ€æ±‚å’ŒæŠ€è¡“è¦æ ¼ã€‚*
